"use strict";function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function insertMark(e,t,n){return"".concat(e.slice(0,t),"<mark>").concat(e.slice(t,t+n),"</mark>").concat(e.slice(t+n))}function randomArrElement(e){return e[Math.floor(Math.random()*e.length)]}function addBodyClass(){document.querySelector("body").classList.add("shadow")}function removeBodyClass(){document.querySelector("body").classList.remove("shadow")}var EditComponent=function(){function e(t){_classCallCheck(this,e),this.listItem=t,this.listItemButtons=this.listItem.querySelectorAll("button"),this.component=document.createElement("div"),this.component.className="edit-field-wrapper",this.field=document.createElement("input"),this.field.setAttribute("type","text"),this.field.value=this.listItem.textContent,this.okButton=document.createElement("button"),this.okButton.setAttribute("type","button"),this.okButton.className="color_base",this.okButton.textContent="Ok",this.component.prepend(this.field),this.component.prepend(this.okButton),this.okButton.addEventListener("click",this.editOkButton.bind(this)),this.field.addEventListener("keydown",this.keydownEnter.bind(this))}return _createClass(e,[{key:"keydownEnter",value:function(e){"Enter"===e.code&&(removeBodyClass(),this.updateItem())}},{key:"editOkButton",value:function(e){e.stopPropagation(),removeBodyClass(),this.updateItem()}},{key:"updateItem",value:function(){var e=this;this.component.remove(),this.listItem.textContent=this.field.value,this.listItemButtons.forEach(function(t){e.listItem.prepend(t)}),EditButton.isComponent=!1}}]),e}(),EditButton=function(){function e(t){_classCallCheck(this,e),this.listItem=t,this.elem=document.createElement("button"),this.elem.className="edit-item",this.elem.setAttribute("type","button"),this.elem.addEventListener("click",this.edit.bind(this))}return _createClass(e,[{key:"edit",value:function(t){if(t.stopPropagation(),addBodyClass(),!e.isComponent){var n=new EditComponent(this.listItem);this.listItem.prepend(n.component),n.field.focus(),e.isComponent=!0}}}]),e}();EditButton.isComponent=!1;var RemoveButton=function(){function e(t){_classCallCheck(this,e),this.listItem=t,this.elem=document.createElement("button"),this.elem.className="delete-item",this.elem.setAttribute("type","button"),this.elem.addEventListener("click",this.remove.bind(this))}return _createClass(e,[{key:"remove",value:function(e){e.stopPropagation(),this.listItem.remove()}}]),e}(),Notice=function(){function e(t){var n;_classCallCheck(this,e),this.elem=document.createElement("div"),this.elem.className="notice","success"===t?(this.elem.innerHTML=randomArrElement(["You are awesome! ".concat(n="<span>Data has been saved!<span>"),'"Trust me, you can dance" - Vodka '.concat(n),'"Тяв-тяв, фяв-тяв!" - Зип-зип пуля '.concat(n),'"Ваш інструмент - автомат, а мій - авторучка." - Акула бізнесу '.concat(n),'"Тема! Тема! Ты опоздал, котька уже облызуеться!" - НГ 2020 '.concat(n),'"Фітнес-блогерка та нутриціологіня ділиться лайфхаками, як мінімізувати споживання солодкого!" - The Village '.concat(n)]),this.elem.classList.add("success")):(this.elem.textContent="error",this.elem.classList.add("error")),document.body.prepend(this.elem)}return _createClass(e,[{key:"remove",value:function(){this.elem.remove()}}]),e}(),Item=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prod-item";_classCallCheck(this,e),this.elem=document.createElement("li"),this.elem.textContent=t,this.elem.className=n,this.elem.addEventListener("click",this.selected.bind(this))}return _createClass(e,[{key:"selected",value:function(e){e.target.closest(".edit-field-wrapper")||(this.elem.classList.contains("disabled")?(this.elem.classList.remove("disabled"),this.moveUp()):(this.elem.classList.add("disabled"),this.moveDown()))}},{key:"moveUp",value:function(){this.elem.parentElement.prepend(this.elem)}},{key:"moveDown",value:function(){var e=this;setTimeout(function(){e.elem.parentElement.append(e.elem)},300)}}]),e}(),Field=function(){function e(){_classCallCheck(this,e),this.elem=document.querySelector(".js-field"),this.listParent=document.querySelector(".prod-list"),this.listElems=document.querySelectorAll(".prod-list li"),this.addButton=document.querySelector(".add-button"),this.titleInList=!1,this.elem.addEventListener("input",this.inputListener.bind(this)),this.elem.addEventListener("keydown",this.keydownListener.bind(this)),this.elem.addEventListener("focus",this.focusListener.bind(this)),this.addButton.addEventListener("click",this.clickAddButton.bind(this))}return _createClass(e,[{key:"focusListener",value:function(e){this.elem.value="",this.updateList()}},{key:"inputListener",value:function(e){var t=this.elem.value.toLowerCase();t?this.listElems.forEach(function(e){if(-1==e.innerText.search(t))e.classList.add("hidden");else{e.classList.remove("hidden");var n=e.innerText;e.innerHTML=insertMark(n,e.innerText.search(t),t.length)}}):this.updateList()}},{key:"clickAddButton",value:function(e){this.pushToList()}},{key:"keydownListener",value:function(e){"Enter"===e.code&&this.pushToList()}},{key:"pushToList",value:function(){if(this.elem.value){var e=this.elem.value.toLowerCase();if(this.titleInList=Array.from(this.listElems).find(function(t){return t.textContent===e}),!this.titleInList){var t=new Item(e);this.listParent.prepend(t.elem),this.elem.value="",this.elem.focus(),this.updateList()}}}},{key:"updateList",value:function(){this.listParent.classList.remove("edit-list-active"),this.listElems=this.listParent.querySelectorAll("li"),this.listElems.forEach(function(e){e.classList.remove("hidden"),e.innerHTML=e.textContent})}}]),e}(),app=function(){var e=document.querySelector(".send-button"),t=document.querySelector(".prod-list"),n=document.querySelector(".remove-link"),s=[];fetch("http://axedevelop.com.ua/db/list.json").then(function(e){return e.json()}).then(function(i){Array.isArray(i)&&(s=i),function(){s.forEach(function(e){var n=new Item(e.title,e.classNames);n.elem.classList.contains("disabled")?t.append(n.elem):t.prepend(n.elem)});var i=new Field;e.addEventListener("click",function(e){document.body.classList.add("body_sendscreen");var t=new Notice("success");i.updateList();var n=[];i.listElems.forEach(function(e){var t={};t.classNames=e.className,t.title=e.textContent,n.push(t)}),s=n,fetch("http://axedevelop.com.ua/",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(s)}).then(function(e){if(200===e.status)return e.text()}).then(function(){setTimeout(function(){document.body.classList.remove("body_sendscreen"),t.remove()},2500)}).catch(function(e){console.log(e),document.querySelector(".prod-list").after("Error text")})}),n.addEventListener("click",function(e){if(i.listParent.classList.contains("edit-list-active"))return;i.listParent.classList.add("edit-list-active");i.listElems.forEach(function(e){var t=new RemoveButton(e),n=new EditButton(e);e.prepend(n.elem),e.prepend(t.elem)})})}()}).catch(function(e){document.querySelector(".prod-list").append("Error download data")})};app();